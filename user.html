<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <script src="userjs"></script>
  </head>

  <body>
    <div
      style="
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        height: 62vh;
        margin-top: 40%;
        transform: translateY(-50%);
      "
    >
      <div class="container">
        <button
          style="margin: auto"
          type="button"
          class="btn btn-dark"
          onclick="cambiar()"
          id="botonaccion"
        >
          Iniciar Sesión
        </button>
        <h1 class="text-center">
          <strong
            >Bienvenido a tu <br />
            registro al Festival de las Artes</strong
          >
        </h1>
        <h3 class="text-center">Es hora de registrarte como cliente</h3>
      </div>
      <br />

      <div style="padding: 15px">
        <div class="input-group flex-nowrap">
          <span
            style="background-color: #50256c; color: whitesmoke"
            class="input-group-text"
            id="addon-wrapping"
            >Cédula</span>
          <input
          class="form-control"
            type="text"
            id="cedula"
            placeholder="Coloca tu cédula"
            aria-label="cedula"
            aria-describedby="addon-wrapping"
          />
      </div>
      <br /><br />
      <div class="input-group flex-nowrap">
        <span
          style="background-color: #50256c; color: whitesmoke"
          class="input-group-text"
          id="addon-wrapping"
          >Nombre</span>
        <input
          type="text"
          id="nombre"
          class="form-control"
          aria-label="Name"
          aria-describedby="addon-wrapping"
          placeholder="Coloca tu nombre"
        />
      </div>
        <br /><br />
        <div class="input-group flex-nowrap">
          <span
            style="background-color: #50256c; color: whitesmoke"
            class="input-group-text"
            id="addon-wrapping"
            >Primer Apellido</span>
          <input
            type="text"
            aria-label="Name"
            class="form-control"
            aria-describedby="addon-wrapping"
            id="primerapellido"
            placeholder="Coloca tu  primer apellido"
          />
        </div>
        <br /><br />
        <div class="input-group flex-nowrap">
          <span
            style="background-color: #50256c; color: whitesmoke"
            class="input-group-text"
            id="addon-wrapping"
            >Segundo Apellido</span>
          <input
            type="text"
            aria-label="Name"
            class="form-control"
            aria-describedby="addon-wrapping"
            id="segundoapellido"
            placeholder="Coloca tu segundo apellido"
          />
        </div><br />
      </div>
      <div style="padding: 15px">
        <div class="input-group flex-nowrap">
          <span
            style="background-color: #50256c; color: whitesmoke"
            class="input-group-text"
            id="addon-wrapping"
            >Direccion</span>
          <input
            type="text"
            aria-label="Name"
            class="form-control"
            aria-describedby="addon-wrapping"
            id="direccion"
            placeholder="Coloca tu dirección"
          />
        </div><br /><br />
        <div class="input-group flex-nowrap">
          <span
            style="background-color: #50256c; color: whitesmoke"
            class="input-group-text"
            id="addon-wrapping"
            >Correo</span>
          <input
            type="email"
            aria-label="Mail"
            class="form-control"
            aria-describedby="addon-wrapping"
            id="correo"
            placeholder="Coloca tu correo electrónico	"
          />
        </div><br /><br />
        <div class="input-group flex-nowrap">
          <span
            style="background-color: #50256c; color: whitesmoke"
            class="input-group-text"
            id="addon-wrapping"
            >Tipo</span>
          <input
            type="text"
            aria-label="Name"
            class="form-control"
            aria-describedby="addon-wrapping"
            id="tipo"
            placeholder="Coloca el tipo de usuario que eres"
          />
        </div><br /><br />
        <div class="input-group flex-nowrap">
          <span
            style="background-color: #50256c; color: whitesmoke"
            class="input-group-text"
            id="addon-wrapping"
            >Clave</span>
          <input
            type="password"
            aria-label="password"
            class="form-control"
            aria-describedby="addon-wrapping"
            id="clave"
            placeholder="Coloca tu clave"
          />
        </div><br /><br />
      </div>
      <br />
      <input
        style="margin-bottom: 15px"
        type="button"
        class="btn btn-success"
        id="botonaccion"
        value="Guardar"
        onclick="guardar()"
      />
    </div>
    <br /><br />
    <div style="padding: 15px" id="espacioparatabla"></div>
    <script
      src="https://code.jquery.com/jquery-3.7.0.js"
      integrity="sha256-JlqSTELeR4TLqP0OG9dxM7yDPqX1ox/HfgiSLBj8+kM="
      crossorigin="anonymous"
    ></script>
    <link
      rel="stylesheet"
      href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css"
    />
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"
      integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"
      integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF"
      crossorigin="anonymous"
    ></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>

    <script>
      var listadeusersenmemoria = [];
      var objetousersparamodificar = null;

      var usuarioinstanciado = new User("", "", "", "", "", "", "", "");
      usuarioinstanciado.Seleccionartodos().then(
        function (response) {
          cargartabla(response);
          console.log(response);
        },
        function (err) {
          alert(err);
        }
      );

      function cargartabla(datos) {
        document.getElementById("espacioparatabla").innerHTML =
          '<table style=" color:  #000;" id="usuariotabla" class="display"><thead><th>cedula</th><th>nombre</th><th>primerapellido</th><th>segundoapellido</th><th>direccion</th><th>correo</th><th>tipo</th><th>clave</th><th>Modificar</th><th>Eliminar</th></thead><tbody></tbody></table>';
        listadeusersenmemoria = datos;
        $("#usuariotabla").DataTable({
          data: datos,
          columns: [
            { data: "cedula" },
            { data: "nombre" },
            { data: "primerapellido" },
            { data: "segundoapellido" },
            { data: "direccion" },
            { data: "correo" },
            { data: "tipo" },
            { data: "clave" },
            { data: "modificar" },
            { data: "eliminar" },
          ],
        });
      }
      function guardar() {
        var usuarioinstanciado = new User(
          document.getElementById("cedula").value,
          document.getElementById("nombre").value,
          document.getElementById("primerapellido").value,
          document.getElementById("segundoapellido").value,
          document.getElementById("direccion").value,
          document.getElementById("correo").value,
          document.getElementById("tipo").value,
          document.getElementById("clave").value
        );
        usuarioinstanciado.Guardar().then(
          function (response) {
            cargartabla(response);
            console.log(response);
            alert("Guardado");
          },
          function (err) {
            alert(err);
          }
        );
      }

      function modificausuarioprimerpaso(cedula) {
        for (var ele in listadeusersenmemoria) {
          if (listadeusersenmemoria[ele].cedula == cedula) {
            objetousersparamodificar = listadeusersenmemoria[ele];
            break;
          }
        }

        document.getElementById("cedula").value =
          objetousersparamodificar.cedula;
        document.getElementById("nombre").value =
          objetousersparamodificar.nombre;
        document.getElementById("primerapellido").value =
          objetousersparamodificar.primerapellido;
        document.getElementById("segundoapellido").value =
          objetousersparamodificar.segundoapellido;
        document.getElementById("direccion").value =
          objetousersparamodificar.direccion;
        document.getElementById("correo").value =
          objetousersparamodificar.correo;
        document.getElementById("tipo").value = objetousersparamodificar.tipo;
        document.getElementById("clave").value = objetousersparamodificar.clave;
        document.getElementById("botonaccion").value = "Modificar";
        document
          .getElementById("botonaccion")
          .setAttribute("onClick", "modificaenarchivo()");
      }

      function modificaenarchivo() {
        var usuarioinstanciado = new User(
          document.getElementById("cedula").value,
          document.getElementById("nombre").value,
          document.getElementById("primerapellido").value,
          document.getElementById("segundoapellido").value,
          document.getElementById("direccion").value,
          document.getElementById("correo").value,
          document.getElementById("tipo").value,
          document.getElementById("clave").value
        );
        usuarioinstanciado.Modificar().then(
          function (response) {
            cargartabla(response);
            console.log(response);
            alert("Modificado");
            (document.getElementById("cedula").value = ""),
              (document.getElementById("nombre").value = ""),
              (document.getElementById("primerapellido").value = ""),
              (document.getElementById("segundoapellido").value = ""),
              (document.getElementById("direccion").value = ""),
              (document.getElementById("correo").value = ""),
              (document.getElementById("tipo").value = ""),
              (document.getElementById("clave").value = "");
            document.getElementById("botonaccion").value = "Guardar";
            document
              .getElementById("botonaccion")
              .setAttribute("onClick", "guardar()");
          },
          function (err) {
            alert(err);
          }
        );
      }
      function eliminausuario(cedula) {
        var usuarioinstanciado = new User(cedula, "", "", "", "", "", "", "");
        usuarioinstanciado.Eliminar().then(
          function (response) {
            cargartabla(response);
            console.log(response);
            alert("Eliminado");
          },
          function (err) {
            alert(err);
          }
        );
      }
      function cambiar() {
        window.location.href = "/";
      }
    </script>
  </body>
</html>
